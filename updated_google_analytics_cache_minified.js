function removeStorage(e){try{localStorage.removeItem(e),localStorage.removeItem(e+"_expiresIn")}catch(t){return console.log("removeStorage: Error removing key ["+e+"] from localStorage: "+JSON.stringify(t)),!1}return!0}function getStorage(e){var t=Date.now(),n=localStorage.getItem(e+"_expiresIn");if(null==n&&(n=0),n<t)return removeStorage(e),null;try{return localStorage.getItem(e)}catch(t){return console.log("getStorage: Error reading key ["+e+"] from localStorage: "+JSON.stringify(t)),null}}function setStorage(e,t,n){n=null==n?360:Math.abs(n);var r=Date.now()+1e3*n;try{localStorage.setItem(e,t),localStorage.setItem(e+"_expiresIn",r)}catch(t){return console.log("setStorage: Error setting key ["+e+"] in localStorage: "+JSON.stringify(t)),!1}return!0}async function coursesRequest(e){let t=await fetch("/api/v1/users/self/courses?per_page=100"),n=await t.text();n=n.substr(9),n=JSON.parse(n);var r=JSON.stringify(n);return setStorage("ga_enrollments",r,null),parseCourses(e,r)}function parseCourses(e,t){if(null!=t){let r=JSON.parse(t);for(var n=0;n<r.length;n++)if(r[n].id==e)return r[n]}return null}function gaCourseDimensions(e){ga("set","dimension4",e.id),ga("set","dimension5",e.name),ga("set","dimension6",e.account_id),ga("set","dimension7",e.enrollment_term_id),ga("set","dimension8",e.enrollments[0].type),ga("send","pageview")}function googleAnalyticsCode(e){var t,n,r,o;if(ga("create",e,"auto"),t=ENV.current_user_id,n=ENV.current_user_roles,ga("set","userId",t),ga("set","dimension1",t),ga("set","dimension3",n),o=window.location.pathname.match(/\/courses\/(\d+)/)){o=o[1],r=0;try{let e=getStorage("ga_enrollments");if(null!=e){var a=parseCourses(o,e);null===a?coursesRequest(o).then(e=>{null===e?(ga("set","dimension4",o),ga("send","pageview")):gaCourseDimensions(e)}):gaCourseDimensions(a)}else coursesRequest(o).then(e=>{null===e?(ga("set","dimension4",o),ga("send","pageview")):gaCourseDimensions(e)})}catch(e){if((r+=1)>5)return ga("set","dimension4",o),void ga("send","pageview")}}else ga("send","pageview")}!function(e,t,n,r,o,a,s){e.GoogleAnalyticsObject=o,e.ga=e.ga||function(){(e.ga.q=e.ga.q||[]).push(arguments)},e.ga.l=1*new Date,a=t.createElement(n),s=t.getElementsByTagName(n)[0],a.async=1,a.src="https://www.google-analytics.com/analytics.js",s.parentNode.insertBefore(a,s)}(window,document,"script",0,"ga");
googleAnalyticsCode("UA-12345678-1");